# ╭─────────────────────────────────────────────────────────╮
# │                    Yazi 主配置文件                      │
# ╰─────────────────────────────────────────────────────────╯

# ═══════════════════════════════════════════════════════════
#  插件配置
# ═══════════════════════════════════════════════════════════

[plugin]
# 压缩文件预览器 - 使用 ouch 插件预览各种压缩格式
prepend_previewers = [
	{ mime = "application/*zip",            run = "ouch" },
	{ mime = "application/x-tar",           run = "ouch" },
	{ mime = "application/x-bzip2",         run = "ouch" },
	{ mime = "application/x-7z-compressed", run = "ouch" },
	{ mime = "application/x-rar",           run = "ouch" },
	{ mime = "application/vnd.rar",         run = "ouch" },
	{ mime = "application/x-xz",            run = "ouch" },
	{ mime = "application/xz",              run = "ouch" },
	{ mime = "application/x-zstd",          run = "ouch" },
	{ mime = "application/zstd",            run = "ouch" },
	{ mime = "application/java-archive",    run = "ouch" },
	# 目录预览器 - 使用 eza 显示目录树结构
	{ url = "*/", run = 'piper -- eza -TL=3 --color=always --icons=always --group-directories-first --no-quotes "$1"' },
]

# ═══════════════════════════════════════════════════════════
#  文件打开器配置
# ═══════════════════════════════════════════════════════════

[opener]
# 文本编辑器 - 使用 Neovim 编辑文本文件
edit = [
	{ run = 'nvim "$@"', block = true, desc = "Edit with Neovim", for = "unix" },
]

# 解压操作 - 使用 ouch 解压文件
extract = [
	{ run = 'ouch d -y %*',   desc = "Extract here with ouch", for = "windows" },
	{ run = 'ouch d -y "$@"', desc = "Extract here with ouch", for = "unix" },
]

# 使用系统默认程序打开
open_with_default = [
	{ run = 'xdg-open "$@"', desc = "Open with default app", for = "unix" },
	{ run = 'open "$@"', desc = "Open with default app", for = "macos" },
	{ run = 'start "" %*', desc = "Open with default app", for = "windows" },
]

# 在浏览器中打开
open_in_browser = [
	{ run = 'xdg-open "$@"', desc = "Open in browser", for = "unix" },
	{ run = 'open "$@"', desc = "Open in browser", for = "macos" },
	{ run = 'start "" %*', desc = "Open in browser", for = "windows" },
]

# 图片查看器 - 使用 qimgv 查看图片
image_viewer = [
	{ run = 'qimgv "$@"', orphan = true, desc = "Open with qimgv", for = "unix" },
]

# ═══════════════════════════════════════════════════════════
#  默认打开方式
# ═══════════════════════════════════════════════════════════

# 为文本文件设置默认编辑器
[open]
rules = [
	# 文本文件 - 使用编辑器打开
	{ mime = "text/*", use = "edit" },
	{ mime = "application/json", use = "edit" },
	{ mime = "application/x-yaml", use = "edit" },
	{ mime = "text/yaml", use = "edit" },
	{ mime = "text/x-yaml", use = "edit" },
	{ mime = "application/toml", use = "edit" },
	{ mime = "application/xml", use = "edit" },
	{ mime = "inode/x-empty", use = "edit" },

	# 按文件名匹配 YAML 文件
	{ name = "*.yml", use = "edit" },
	{ name = "*.yaml", use = "edit" },

	# Markdown 文件
	{ name = "*.md", use = "edit" },
	{ name = "*.markdown", use = "edit" },
	{ mime = "text/markdown", use = "edit" },

	# PDF 文件 - 使用系统默认程序打开
	{ name = "*.pdf", use = "open_with_default" },
	{ mime = "application/pdf", use = "open_with_default" },

	# 图片文件 - 使用 qimgv 查看
	{ mime = "image/*", use = "image_viewer" },
	{ name = "*.jpg", use = "image_viewer" },
	{ name = "*.jpeg", use = "image_viewer" },
	{ name = "*.png", use = "image_viewer" },
	{ name = "*.gif", use = "image_viewer" },
	{ name = "*.bmp", use = "image_viewer" },
	{ name = "*.webp", use = "image_viewer" },
	{ name = "*.svg", use = "image_viewer" },
	{ name = "*.ico", use = "image_viewer" },
	{ name = "*.tiff", use = "image_viewer" },
	{ name = "*.tif", use = "image_viewer" },

	# 其他常见文本格式
	{ name = "*.txt", use = "edit" },
	{ name = "*.conf", use = "edit" },
	{ name = "*.config", use = "edit" },
	{ name = "*.ini", use = "edit" },
	{ name = "*.log", use = "edit" },
	{ name = "*.sh", use = "edit" },
	{ name = "*.bash", use = "edit" },
	{ name = "*.zsh", use = "edit" },
	{ name = "*.fish", use = "edit" },
	{ name = "*.py", use = "edit" },
	{ name = "*.js", use = "edit" },
	{ name = "*.ts", use = "edit" },
	{ name = "*.jsx", use = "edit" },
	{ name = "*.tsx", use = "edit" },
	{ name = "*.rs", use = "edit" },
	{ name = "*.go", use = "edit" },
	{ name = "*.c", use = "edit" },
	{ name = "*.cpp", use = "edit" },
	{ name = "*.h", use = "edit" },
	{ name = "*.hpp", use = "edit" },
	{ name = "*.java", use = "edit" },
	{ name = "*.css", use = "edit" },
	{ name = "*.scss", use = "edit" },
	{ name = "*.html", use = "edit" },
	{ name = "*.htm", use = "edit" },
	{ name = "*.vue", use = "edit" },
	{ name = "*.svelte", use = "edit" },
	{ name = "*.lua", use = "edit" },
	{ name = "*.vim", use = "edit" },
	{ name = "*.sql", use = "edit" },
	{ name = "Makefile", use = "edit" },
	{ name = "Dockerfile", use = "edit" },
	{ name = ".gitignore", use = "edit" },
	{ name = ".gitattributes", use = "edit" },
	{ name = "README", use = "edit" },
	{ name = "LICENSE", use = "edit" },

	# 压缩文件 - 使用解压工具 (按 MIME 类型)
	{ mime = "application/*zip", use = "extract" },
	{ mime = "application/x-tar", use = "extract" },
	{ mime = "application/x-bzip2", use = "extract" },
	{ mime = "application/x-7z-compressed", use = "extract" },
	{ mime = "application/x-rar", use = "extract" },
	{ mime = "application/vnd.rar", use = "extract" },
	{ mime = "application/x-xz", use = "extract" },
	{ mime = "application/xz", use = "extract" },
	{ mime = "application/x-zstd", use = "extract" },
	{ mime = "application/zstd", use = "extract" },
	{ mime = "application/java-archive", use = "extract" },

	# 按文件名匹配压缩文件
	{ name = "*.zip", use = "extract" },
	{ name = "*.tar", use = "extract" },
	{ name = "*.tar.gz", use = "extract" },
	{ name = "*.tgz", use = "extract" },
	{ name = "*.tar.bz2", use = "extract" },
	{ name = "*.tbz2", use = "extract" },
	{ name = "*.tar.xz", use = "extract" },
	{ name = "*.txz", use = "extract" },
	{ name = "*.tar.zst", use = "extract" },
	{ name = "*.7z", use = "extract" },
	{ name = "*.rar", use = "extract" },
	{ name = "*.jar", use = "extract" },
]
