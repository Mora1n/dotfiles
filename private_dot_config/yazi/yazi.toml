# ╭─────────────────────────────────────────────────────────╮
# │                    Yazi Main Config                     │
# ╰─────────────────────────────────────────────────────────╯

# ═══════════════════════════════════════════════════════════
#  Plugin Config
# ═══════════════════════════════════════════════════════════

[plugin]
# Archive previewer - preview compressed files using ouch
prepend_previewers = [
	{ mime = "application/*zip",            run = "ouch" },
	{ mime = "application/x-tar",           run = "ouch" },
	{ mime = "application/x-bzip2",         run = "ouch" },
	{ mime = "application/x-7z-compressed", run = "ouch" },
	{ mime = "application/x-rar",           run = "ouch" },
	{ mime = "application/vnd.rar",         run = "ouch" },
	{ mime = "application/x-xz",            run = "ouch" },
	{ mime = "application/xz",              run = "ouch" },
	{ mime = "application/x-zstd",          run = "ouch" },
	{ mime = "application/zstd",            run = "ouch" },
	{ mime = "application/java-archive",    run = "ouch" },
	# Directory previewer - show tree structure using eza
	{ url = "*/", run = 'piper -- eza -TL=3 --color=always --icons=always --group-directories-first --no-quotes "$1"' },
]

# ═══════════════════════════════════════════════════════════
#  Opener Config
# ═══════════════════════════════════════════════════════════

[opener]
# Text editor
edit = [
	{ run = 'nvim "$@"', block = true, desc = "Edit with Neovim", for = "unix" },
]

# Extract archives
extract = [
	{ run = 'ouch d -y %*',   desc = "Extract here with ouch", for = "windows" },
	{ run = 'ouch d -y "$@"', desc = "Extract here with ouch", for = "unix" },
]

# Open with system default
open_with_default = [
	{ run = 'xdg-open "$@"', desc = "Open with default app", for = "unix" },
	{ run = 'open "$@"', desc = "Open with default app", for = "macos" },
	{ run = 'start "" %*', desc = "Open with default app", for = "windows" },
]

# Open in browser
open_in_browser = [
	{ run = 'xdg-open "$@"', desc = "Open in browser", for = "unix" },
	{ run = 'open "$@"', desc = "Open in browser", for = "macos" },
	{ run = 'start "" %*', desc = "Open in browser", for = "windows" },
]

# Image viewer
image_viewer = [
	{ run = 'qimgv "$@"', orphan = true, desc = "Open with qimgv", for = "unix" },
]

# ═══════════════════════════════════════════════════════════
#  Default Opener Rules
# ═══════════════════════════════════════════════════════════

[open]
rules = [
	# Text files
	{ mime = "text/*", use = "edit" },
	{ mime = "application/json", use = "edit" },
	{ mime = "application/x-yaml", use = "edit" },
	{ mime = "text/yaml", use = "edit" },
	{ mime = "text/x-yaml", use = "edit" },
	{ mime = "application/toml", use = "edit" },
	{ mime = "application/xml", use = "edit" },
	{ mime = "application/javascript", use = "edit" },
	{ mime = "application/x-sh", use = "edit" },
	{ mime = "application/x-shellscript", use = "edit" },
	{ mime = "inode/x-empty", use = "edit" },

	# YAML files by name
	{ name = "*.yml", use = "edit" },
	{ name = "*.yaml", use = "edit" },

	# TOML files by name
	{ name = "*.toml", use = "edit" },

	# Markdown files
	{ name = "*.md", use = "edit" },
	{ name = "*.markdown", use = "edit" },
	{ mime = "text/markdown", use = "edit" },

	# PDF files
	{ name = "*.pdf", use = "open_with_default" },
	{ mime = "application/pdf", use = "open_with_default" },

	# Image files
	{ mime = "image/*", use = "image_viewer" },
	{ name = "*.jpg", use = "image_viewer" },
	{ name = "*.jpeg", use = "image_viewer" },
	{ name = "*.png", use = "image_viewer" },
	{ name = "*.gif", use = "image_viewer" },
	{ name = "*.bmp", use = "image_viewer" },
	{ name = "*.webp", use = "image_viewer" },
	{ name = "*.svg", use = "image_viewer" },
	{ name = "*.ico", use = "image_viewer" },
	{ name = "*.tiff", use = "image_viewer" },
	{ name = "*.tif", use = "image_viewer" },

	# Common text formats
	{ name = "*.txt", use = "edit" },
	{ name = "*.conf", use = "edit" },
	{ name = "*.config", use = "edit" },
	{ name = "*.ini", use = "edit" },
	{ name = "*.log", use = "edit" },
	{ name = "*.sh", use = "edit" },
	{ name = "*.bash", use = "edit" },
	{ name = "*.zsh", use = "edit" },
	{ name = "*.fish", use = "edit" },
	{ name = "*.py", use = "edit" },
	{ name = "*.js", use = "edit" },
	{ name = "*.ts", use = "edit" },
	{ name = "*.jsx", use = "edit" },
	{ name = "*.tsx", use = "edit" },
	{ name = "*.rs", use = "edit" },
	{ name = "*.go", use = "edit" },
	{ name = "*.c", use = "edit" },
	{ name = "*.cpp", use = "edit" },
	{ name = "*.h", use = "edit" },
	{ name = "*.hpp", use = "edit" },
	{ name = "*.java", use = "edit" },
	{ name = "*.css", use = "edit" },
	{ name = "*.scss", use = "edit" },
	{ name = "*.html", use = "edit" },
	{ name = "*.htm", use = "edit" },
	{ name = "*.vue", use = "edit" },
	{ name = "*.svelte", use = "edit" },
	{ name = "*.lua", use = "edit" },
	{ name = "*.vim", use = "edit" },
	{ name = "*.sql", use = "edit" },
	{ name = "Makefile", use = "edit" },
	{ name = "Dockerfile", use = "edit" },
	{ name = ".gitignore", use = "edit" },
	{ name = ".gitattributes", use = "edit" },
	{ name = "README", use = "edit" },
	{ name = "LICENSE", use = "edit" },
	{ name = "*.json", use = "edit" },
	{ name = "*.xml", use = "edit" },
	{ name = "*.csv", use = "edit" },
	{ name = "*.env", use = "edit" },
	{ name = ".env*", use = "edit" },
	{ name = "*.properties", use = "edit" },
	{ name = "*.gradle", use = "edit" },
	{ name = "*.cmake", use = "edit" },
	{ name = "CMakeLists.txt", use = "edit" },
	{ name = "*.gitconfig", use = "edit" },
	{ name = ".gitmodules", use = "edit" },
	{ name = "*.editorconfig", use = "edit" },
	{ name = ".editorconfig", use = "edit" },

	# Archive files by MIME
	{ mime = "application/*zip", use = "extract" },
	{ mime = "application/x-tar", use = "extract" },
	{ mime = "application/x-bzip2", use = "extract" },
	{ mime = "application/x-7z-compressed", use = "extract" },
	{ mime = "application/x-rar", use = "extract" },
	{ mime = "application/vnd.rar", use = "extract" },
	{ mime = "application/x-xz", use = "extract" },
	{ mime = "application/xz", use = "extract" },
	{ mime = "application/x-zstd", use = "extract" },
	{ mime = "application/zstd", use = "extract" },
	{ mime = "application/java-archive", use = "extract" },

	# Archive files by name
	{ name = "*.zip", use = "extract" },
	{ name = "*.tar", use = "extract" },
	{ name = "*.tar.gz", use = "extract" },
	{ name = "*.tgz", use = "extract" },
	{ name = "*.tar.bz2", use = "extract" },
	{ name = "*.tbz2", use = "extract" },
	{ name = "*.tar.xz", use = "extract" },
	{ name = "*.txz", use = "extract" },
	{ name = "*.tar.zst", use = "extract" },
	{ name = "*.7z", use = "extract" },
	{ name = "*.rar", use = "extract" },
	{ name = "*.jar", use = "extract" },
]
