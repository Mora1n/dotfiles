# ===============================================
# TMUX CONFIGURATION
# ===============================================

# Terminal and Color Settings
# ===============================================
set -g default-terminal "screen-256color"

# Input and Navigation
# ===============================================
set -g mouse on                    # Enable mouse support
set -g mode-keys vi                # Use vi-style key bindings

# Performance and Response Speed
# ===============================================
set -sg escape-time 0              # No delay for escape key press
set -g repeat-time 600             # Increase repeat timeout to 600ms
set -g focus-events on             # Enable focus events for terminals
set -g aggressive-resize on        # Resize window when smaller client disconnects

# Window Status and Appearance
# ===============================================
set -g status-position bottom      # Status bar at bottom
set -g status-justify left         # Left-align window list

# Custom Key Bindings
# ===============================================
unbind C-b                         # Remove default prefix
set -g prefix C-_                  # Set primary prefix to Ctrl+_
set -g prefix2 M-z                 # Set secondary prefix to Alt+z
bind C-_ send-prefix               # Send prefix through to applications
bind M-z send-prefix -2            # Send secondary prefix

# Session Management
# ===============================================
bind S new-session                 # Create new session with prefix+S
bind L switch-client -l            # Switch to last session with prefix+L
bind D detach-client               # Detach current session with prefix+D
bind r source-file ~/.config/tmux/tmux.conf \; display "Config reloaded!"

# Vi Mode Copy Operations
# ===============================================
bind Enter copy-mode               # Enter copy mode with prefix+Enter
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind -T copy-mode-vi y send-keys -X copy-selection-and-cancel
bind -T copy-mode-vi Escape send-keys -X cancel
bind -T copy-mode-vi H send-keys -X start-of-line
bind -T copy-mode-vi L send-keys -X end-of-line

# System Clipboard Integration
# ===============================================
bind C-c run "tmux save-buffer - | xsel -i -b"
bind C-v run "tmux set-buffer \"$(xsel -o -b)\"; tmux paste-buffer"
set -g set-clipboard on            # Enable clipboard integration

# Plugin Manager and Plugins
# ===============================================
set -g @plugin "tmux-plugins/tpm"
set -g @plugin "tmux-plugins/tmux-sensible"      # Sensible defaults
set -g @plugin "tmux-plugins/tmux-resurrect"     # Save/restore sessions
set -g @plugin "tmux-plugins/tmux-continuum"     # Automatic session saving
set -g @plugin "tmux-plugins/tmux-pain-control"  # Better pane management
set -g @plugin "tmux-plugins/tmux-yank"          # Enhanced copy/paste
set -g @plugin "dracula/tmux"                    # Dracula theme

# Plugin Configuration
# ===============================================

# tmux-resurrect settings
set -g @resurrect-strategy-vim "session"         # Restore vim sessions
set -g @resurrect-strategy-nvim "session"        # Restore neovim sessions
set -g @resurrect-capture-pane-contents "on"     # Save pane contents
set -g @resurrect-processes 'ssh psql mysql sqlite3'  # Additional programs to restore

# tmux-continuum settings
set -g @continuum-restore "on"                   # Auto-restore on tmux start
set -g @continuum-save-interval "15"             # Save every 15 minutes
set -g @continuum-boot "on"                      # Start tmux on system boot

# tmux-yank settings
set -g @yank_selection_mouse 'clipboard'         # Mouse selection to clipboard
set -g @yank_action 'copy-pipe-and-cancel'       # Copy and exit selection mode

# Dracula theme settings
# ===============================================
set -g @dracula-plugins "cpu-usage ram-usage time"
set -g @dracula-show-powerline true
set -g @dracula-show-flags true
set -g @dracula-show-left-icon session
set -g @dracula-left-icon-padding 1
set -g @dracula-refresh-rate 5

# CPU usage settings
set -g @dracula-cpu-usage-label "CPU"
set -g @dracula-cpu-usage-colors "pink dark_gray"

# RAM usage settings
set -g @dracula-ram-usage-label "RAM"
set -g @dracula-ram-usage-colors "cyan dark_gray"

# Network settings
set -g @dracula-network-colors "green dark_gray"
set -g @dracula-network-wifi-label "󰖩"
set -g @dracula-network-ethernet-label "󰈀"
set -g @dracula-network-offline-label "󱍢"

# Time settings
set -g @dracula-time-colors "orange dark_gray"
set -g @dracula-time-format "%F %R"

# Initialize TPM (keep at bottom)
# ===============================================
run "~/.config/tmux/plugins/tpm/tpm"
