# ╔══════════════════════════════════════════════════════════════════════════════╗
# ║                              TMUX CONFIGURATION                              ║
# ╚══════════════════════════════════════════════════════════════════════════════╝

# ┌─ Terminal ──────────────────────────────────────────────────────────────────┐
set -g default-terminal "screen-256color"    # Enable 256-color support

# ┌─ Input & Navigation ────────────────────────────────────────────────────────┐
set -g mouse on                              # Full mouse interaction support
set -g mode-keys vi                          # Vim-style key bindings

# ┌─ Performance ───────────────────────────────────────────────────────────────┐
set -sg escape-time 0                        # Instant escape key response
set -g repeat-time 600                       # Key repeat timeout
set -g focus-events on                       # Application focus detection
set -g aggressive-resize on                  # Smart window resizing

# ┌─ Status Bar ────────────────────────────────────────────────────────────────┐
set -g status-position bottom                # Bottom status bar placement
set -g status-justify left                  # Left-aligned window list

# ┌─ Key Bindings ──────────────────────────────────────────────────────────────┐
unbind C-b                                   # Remove default prefix
set -g prefix C-_                            # Primary prefix (Ctrl+_)
set -g prefix2 M-z                           # Secondary prefix (Alt+z)
bind C-_ send-prefix                         # Send prefix passthrough
bind M-z send-prefix -2                      # Send secondary prefix

# ┌─ Session Management ────────────────────────────────────────────────────────┐
bind S new-session                           # Create new session
bind L switch-client -l                      # Switch to last session
bind D detach-client                         # Detach current session
bind r source-file ~/.config/tmux/tmux.conf \; display "Config reloaded!"

# ┌─ Vi Copy Mode ──────────────────────────────────────────────────────────────┐
bind Enter copy-mode                         # Enter copy mode
bind -T copy-mode-vi v send-keys -X begin-selection          # Visual selection
bind -T copy-mode-vi C-v send-keys -X rectangle-toggle       # Block selection
bind -T copy-mode-vi y send-keys -X copy-selection-and-cancel # Copy and exit
bind -T copy-mode-vi Escape send-keys -X cancel              # Exit copy mode
bind -T copy-mode-vi H send-keys -X start-of-line            # Jump to line start
bind -T copy-mode-vi L send-keys -X end-of-line              # Jump to line end

# ┌─ Clipboard ─────────────────────────────────────────────────────────────────┐
bind C-c run "tmux save-buffer - | xsel -i -b"               # Copy to system
bind C-v run "tmux set-buffer \"$(xsel -o -b)\"; tmux paste-buffer" # Paste from system
set -g set-clipboard on                      # Automatic clipboard sync

# ┌─ Plugins ───────────────────────────────────────────────────────────────────┐
set -g @plugin "tmux-plugins/tpm"              # Plugin manager
set -g @plugin "tmux-plugins/tmux-sensible"    # Sensible defaults
set -g @plugin "tmux-plugins/tmux-resurrect"   # Session persistence
set -g @plugin "tmux-plugins/tmux-continuum"   # Auto session save/restore
set -g @plugin "tmux-plugins/tmux-pain-control" # Better pane management
set -g @plugin "tmux-plugins/tmux-yank"        # Enhanced copy/paste
set -g @plugin "dracula/tmux"                  # Beautiful theme

# ┌─ Session Persistence ──────────────────────────────────────────────────────┐
set -g @resurrect-strategy-vim "session"       # Restore vim sessions
set -g @resurrect-strategy-nvim "session"      # Restore neovim sessions
set -g @resurrect-capture-pane-contents "on"   # Save pane content
set -g @resurrect-processes 'ssh psql mysql sqlite3' # Restore these processes

# ┌─ Auto Save/Restore ─────────────────────────────────────────────────────────┐
set -g @continuum-restore "off"                # Manual session restore
set -g @continuum-save-interval "360"          # Save every 6 minutes
set -g @continuum-boot "on"                    # Start tmux on system boot

# ┌─ Copy Enhancement ──────────────────────────────────────────────────────────┐
set -g @yank_selection_mouse 'clipboard'       # Mouse selection target
set -g @yank_action 'copy-pipe-and-cancel'     # Copy behavior

# ┌─ Theme Configuration ───────────────────────────────────────────────────────┐
set -g @dracula-plugins "ssh-session cwd cpu-usage ram-usage time" # Status modules
set -g @dracula-show-powerline true            # Fancy powerline symbols
set -g @dracula-show-left-icon "session"       # Session icon display
# set -g @dracula-transparent-powerline-bg true  # Transparent background
set -g @dracula-refresh-rate 5                 # Update frequency (seconds)
set -g @dracula-show-empty-plugins false       # Hide inactive modules
set -g @dracula-border-contrast true           # Enhanced border visibility

# ┌─ Theme Customization ───────────────────────────────────────────────────────┐
set -g @dracula-cpu-usage-label "CPU"          # CPU usage display
set -g @dracula-ram-usage-label "RAM"          # Memory usage display
set -g @dracula-cwd-label "󰉋"                  # Directory indicator
set -g @dracula-ssh-session-label "󰢪"          # SSH connection indicator
set -g @dracula-show-ssh-only-when-connected true # Smart SSH visibility
set -g @dracula-show-ssh-session-port true     # Show SSH port numbers
set -g @dracula-time-format "%F %R"            # Date and time format

# ┌─ Initialize Plugin Manager ────────────────────────────────────────────────┐
run "~/.config/tmux/plugins/tpm/tpm"
