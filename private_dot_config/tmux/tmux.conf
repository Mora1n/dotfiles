# =============================================================================
#                              TMUX CONFIGURATION
# =============================================================================

# Terminal Settings
# =============================================================================
set -g default-terminal "screen-256color"    # Set terminal type

# Input and Navigation
# =============================================================================
set -g mouse on                    # Enable mouse support
set -g mode-keys vi                # Use vi key bindings

# Performance Settings
# =============================================================================
set -sg escape-time 0              # Remove escape key delay
set -g repeat-time 600             # Set repeat timeout
set -g focus-events on             # Enable focus events
set -g aggressive-resize on        # Aggressive window resizing

# Status Bar Layout
# =============================================================================
set -g status-position bottom      # Status bar position
set -g status-justify left         # Window list alignment

# Key Bindings
# =============================================================================
unbind C-b                         # Remove default prefix
set -g prefix C-_                  # Primary prefix key
set -g prefix2 M-z                 # Secondary prefix key
bind C-_ send-prefix               # Send prefix to applications
bind M-z send-prefix -2            # Send secondary prefix

# Session Management
# =============================================================================
bind S new-session                 # Create new session
bind L switch-client -l            # Switch to last session
bind D detach-client               # Detach session
bind r source-file ~/.config/tmux/tmux.conf \; display "Config reloaded!"

# Vi Copy Mode
# =============================================================================
bind Enter copy-mode               # Enter copy mode
bind -T copy-mode-vi v send-keys -X begin-selection          # Begin selection
bind -T copy-mode-vi C-v send-keys -X rectangle-toggle       # Rectangle toggle
bind -T copy-mode-vi y send-keys -X copy-selection-and-cancel # Copy and exit
bind -T copy-mode-vi Escape send-keys -X cancel              # Cancel selection
bind -T copy-mode-vi H send-keys -X start-of-line            # Move to line start
bind -T copy-mode-vi L send-keys -X end-of-line              # Move to line end

# Clipboard Integration
# =============================================================================
bind C-c run "tmux save-buffer - | xsel -i -b"               # Copy to system clipboard
bind C-v run "tmux set-buffer \"$(xsel -o -b)\"; tmux paste-buffer" # Paste from system clipboard
set -g set-clipboard on            # Enable clipboard support

# Plugin Manager
# =============================================================================
set -g @plugin "tmux-plugins/tpm"              # Plugin manager
set -g @plugin "tmux-plugins/tmux-sensible"      # Sensible defaults
set -g @plugin "tmux-plugins/tmux-resurrect"     # Session persistence
set -g @plugin "tmux-plugins/tmux-continuum"     # Auto session save
set -g @plugin "tmux-plugins/tmux-pain-control"  # Pane management
set -g @plugin "tmux-plugins/tmux-yank"          # Copy/paste enhancement
set -g @plugin "dracula/tmux"                    # Theme

# Plugin Configuration
# =============================================================================

# Resurrect Settings
set -g @resurrect-strategy-vim "session"         # Vim session restore
set -g @resurrect-strategy-nvim "session"        # Neovim session restore
set -g @resurrect-capture-pane-contents "on"     # Save pane contents
set -g @resurrect-processes 'ssh psql mysql sqlite3' # Programs to restore

# Continuum Settings
set -g @continuum-restore "on"                   # Auto-restore sessions
set -g @continuum-save-interval "360"            # Save interval
set -g @continuum-boot "on"                      # Start on boot

# Yank Settings
set -g @yank_selection_mouse 'clipboard'         # Mouse selection behavior
set -g @yank_action 'copy-pipe-and-cancel'       # Copy action

# Dracula Theme
# =============================================================================
set -g @dracula-plugins "cwd cpu-usage ram-usage time"  # Status bar plugins
set -g @dracula-show-powerline true              # Powerline symbols
set -g @dracula-show-left-icon "#h"               # Left icon display
set -g @dracula-refresh-rate 5                   # Refresh interval
set -g @dracula-show-empty-plugins false         # Hide empty plugins

# Theme Plugin Settings
set -g @dracula-cpu-usage-label "CPU"            # CPU usage label
set -g @dracula-ram-usage-label "RAM"            # RAM usage label
set -g @dracula-cwd-label "󰉋"                    # Directory icon
set -g @dracula-ssh-session-label "󰢪"            # SSH session icon
set -g @dracula-show-ssh-only-when-connected true # SSH visibility
set -g @dracula-show-ssh-session-port true       # SSH port display
set -g @dracula-time-format "%F %R"              # Time format

# Initialize Plugin Manager (keep at bottom)
# =============================================================================
run "~/.config/tmux/plugins/tpm/tpm"
